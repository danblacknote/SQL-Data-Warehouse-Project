```sql
-- This script drops and recreates a DataWarehouse database with three schemas (bronze, silver, gold)
-- for a medallion architecture data pipeline. It forces the closure of existing connections.
______________________________________________________________________________________________________

USE master;

--Droep, this database already exists
IF EXISTS(SELECT 1 FROM sys.databases WHERE name='DataWarehouse')
BEGIN 
    ALTER DATABASE DataWarehouse SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
    DROP DATABASE DataWarehouse;
END
GO

--Create The DataWarehouse Database
CREATE DATABASE DataWarehouse;
GO

USE DataWarehouse;
GO

--Create The Bronze Layer
CREATE SCHEMA bronze;
GO

--Create The Silver Layer
CREATE SCHEMA silver;
GO

--Create The Gold Layer
CREATE SCHEMA gold;
GO

